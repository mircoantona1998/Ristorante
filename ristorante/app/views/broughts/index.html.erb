<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portate</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css">

</head>
<body>

<h1>Portate</h1>
<% if flash[:notice] %>
  <div class="alert alert-success">
    <%= flash[:notice] %>
  </div>
<% end %>
<table class="table">
  <thead>
    <tr>
      <th>Nome</th>
      <th>Ingredienti</th>
      <th>Prezzo</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  <% @broughts.each do |brought| %>
    <tr>
      <td><%= brought.nome %></td>
      <td>
        <% if brought.brought_ingredients.any? %> 
            <ul>
              <% brought.brought_ingredients.each do |brought_ingredient| %>
                <li>
                  <%= brought_ingredient.ingredient.nome %>
                  <% if brought_ingredient.quantita.present? %> 
                    - <%= brought_ingredient.quantita %> <%= brought_ingredient.ingredient.unita_di_misura %> 
                  <% end %>
                </li>
              <% end %>
            </ul>
        <% else %>
          <p>Nessun ingrediente associato.</p>
        <% end %>
      </td>
      <td><%= number_to_currency(brought.prezzo, unit: 'â‚¬', locale: :it) %></td>
      <td class="action-icons">
        <%= link_to edit_brought_path(brought), class: 'action-icon edit' do %>
          <i class="fas fa-edit"></i>
        <% end %>
        <%= form_with model: brought, url: brought_path(brought), method: :delete, local: true do %>
          <%= button_tag type: 'submit', class: 'btn btn-danger action-icon delete' do %>
            <i class="fas fa-trash"></i>  
          <% end %>
        <% end %>
      </td>
    </tr>
  <% end %>
  </tbody>
</table>

<%= link_to '<i class="fas fa-plus"></i>'.html_safe, new_brought_path, class: 'add-button' %>
<%= link_to '<i class="fas fa-home"></i>'.html_safe, root_path, class: 'home-button' %>

</body>
</html>
